import pandas as pd
import numpy as np
import seaborn as sn
data=pd.read_csv('/content/airlines_flights_data.csv')
data.head()
data.tail()
data.columns
data.shape
data.describe()
data.isnull().sum()
#visualization(EDA)
data.head()
sn.relplot(x='price', y='airline', data=data)
sn.countplot(x='airline', data=data)
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import LabelEncoder, StandardScaler
import pandas as pd

# Separate features and target
X = data.drop(['price', 'stops', 'departure_time', 'arrival_time'], axis=1)
y = data['price']

# Encode all categorical (object) columns
label_encoders = {}
for col in X.select_dtypes(include=['object']).columns:
    le = LabelEncoder()
    X[col] = le.fit_transform(X[col])
    label_encoders[col] = le  # store for future use

# Optional: Scale features (helps for some models)
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Train-test split
x_train, x_test, y_train, y_test = train_test_split(
    X_scaled, y, test_size=0.2, random_state=2
)


reg=LinearRegression()
reg.fit(x_train,y_train)

pred=reg.predict(x_test)
pred
reg.score(x_test,y_test)
